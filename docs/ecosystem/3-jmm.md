# Java memory model (JMM), String pool

---

## Heap
Куча содержит все объекты, созданные в вашем приложении, независимо от того, какой поток создал объект. 
- Локальная переменная также может быть ссылкой на объект и хранится в стеке потоков, но сам объект хранится в куче. 
- Статические переменные класса также хранятся в куче. Является областью работы сборщика мусора.

## Stack
Стэк содержит информацию о том, какие методы вызвал поток и все локальные переменные для каждого выполняемого метода. 
- Работает по схеме LIFO (Последний-зашел-Первый-вышел).
- Поток может получить доступ только к своему стеку. Локальные переменные, невидимы для всех других потоков, кроме потока, который их создал. Даже если два потока выполняют один и тот же код, они всё равно будут создавать локальные переменные этого кода в своих собственных стеках. Таким образом, каждый поток имеет свою версию каждой локальной переменной. 
- Все примитивы полностью хранятся в стеке потоков и не видны другим потокам. Один поток может передать копию примитива другому потоку, но не может совместно её использовать.

Куча используется всеми частями приложения, в то время как стек используется только одним потоком исполнения программы.
Всякий раз, когда создается объект, он всегда хранится в куче, а в памяти стека содержится лишь ссылка на него. Память стека содержит только локальные переменные примитивных типов и ссылки на объекты в куче.

---

## String pool

Пул строк — это специальная область в heap-памяти, где хранятся уникальные строковые литералы.
- Возможен благодаря неизменяемости строк в Java и реализации идеи интернирования строк;
- Помогает экономить память, но по этой же причине создание строки занимает больше времени;
- Когда для создания строки используются ", то сначала ищется строка в пуле с таким же значением, если находится, то просто возвращается ссылка, иначе создается новая строка в пуле, а затем возвращается ссылка на неё;
- При использовании оператора new создаётся новый объект String. Затем при помощи метода intern() эту строку можно поместить в пул или же получить из пула ссылку на другой объект String с таким же значением.
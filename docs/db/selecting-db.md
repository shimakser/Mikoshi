# Selecting Database

## Основные Критерии выбора СУБД

1. Тип нагрузки (OLTP / OLAP):
   - Оперативные транзакции → реляционные,
   - аналитика → колоночные.
2. Консистентность (ACID vs BASE):
   - Высокая важность точных данных → ACID (SQL),
   - иначе BASE (NoSQL).
3. Структура данных:
   - Стабильная схема → SQL,
   - Гибкая/меняющаяся схема → NoSQL.
4. Объём и рост данных:
   - Горизонтальный масштаб → NoSQL.
   - вертикальный → SQL.
5. Тип запросов:
   - JOIN, сложная агрегация → SQL,
   - простые ключевые → NoSQL.
6. Наличие транзакций:
   - Нужны многозапросные транзакции → SQL,
   - Иначе — NoSQL.
7. Время ответа:
   < 1ms с миллионами QPS → специализированные NoSQL.
8. Наличие отношений между данными:
   Много отношений → SQL или графовые БД.

---

## Когда выбирать реляционные СУБД (SQL)
- Есть чёткая, стабильная структура данных.
- Нужны сложные запросы с JOIN, GROUP BY, WINDOW FUNCTIONS.
- Важны транзакции, целостность данных.
- Количество данных — умеренное (или делается шардирование).
- Подходит вертикальное масштабирование.

1. PostgreSQL
   - универсальное OLTP, аналитика, GIS, full-text.
   - Расширяемая, ACID, поддержка JSONB
2. MySQL / MariaDB
   - веб-приложения, стартапы, CMS.
   - Лёгкая, быстрая, простой стек.
3. Oracle
   - enterprise ERP/CRM/финансы.
   - Мощная, платная, продвинутая.
4. SQL Server
   - бизнес-системы на .NET.
   - Хорошо интегрируется с Windows
5. SQLite
   - embedded-системы, мобильные приложения.
   - Без сервера, file-based.

---

## Когда выбирать NoSQL СУБД
- Схема может меняться, или данные не структурированы (JSON, документы, графы).
- Горизонтальное масштабирование — ключевое.
- Возможна eventual consistency.
- Требуется высокая скорость записи/чтения.
- Транзакции либо не нужны, либо простые (на уровне одного объекта).
- Модель данных не требует сложных JOIN’ов.

Виды и сценарии NoSQL
1. Документо-ориентированные
   - MongoDB, Couchbase.
   - CMS, REST API, хранение JSON.
   - Гибкая схема, удобные агрегаты.
2. Ключ-значение
   - Redis, DynamoDB.
   - Кэш, сессии, частые запросы по ключу.
   - Сверхбыстрый доступ, TTL.
3. Графовые
   - Neo4j, ArangoDB.
   - Соц. сети, рекомендательные системы.
   - Быстрый обход связей.
4. Колонковые
   - Cassandra, HBase.
   - IoT, логирование, write-heavy.
   - Высокая скорость записи, масштабируемость.
5. Time-series
   - InfluxDB, TimescaleDB.
   - Метрики, логи, сенсоры.
   - Оптимизированы под временные ряды.

---

## Сценарии
1. PostgreSQL / MySQL — Веб-приложение (авторизация, пользователи, корзина):
   - Строгая схема.
   - Отношения между таблицами.
   - Частые небольшие транзакции.
2. MongoDB — CMS или сайт с динамическим контентом.
   - Структура данных гибкая.
   - Часто нет сложных связей между сущностями.
   - Быстрая разработка и расширение схемы.
3. Redis — Кэширование, работа с сессиями, временные данные.
   - Мгновенный доступ по ключу.
   - TTL, Pub/Sub, sorted sets.
   - Простая горизонтальная масштабируемость.
4. Cassandra / ClickHouse / InfluxDB — Хранение и анализ логов / телеметрии / IoT.
   - Cassandra — write-heavy, доступность.
   - ClickHouse — аналитика, колоночная БД.
   - InfluxDB — оптимизация под временные ряды.
5. Neo4j — Графы, отношения, соцсети.
   - Оптимизирована под графовые обходы.
   - Cypher — язык для поиска по графу.
6. Oracle / PostgreSQL — Финансовая система, ERP, банки.
   - Строгая консистентность.
   - Транзакции, изоляция, целостность.
   - Надёжность и безопасность данных.

---

## OLTP vs OLAP
1. OLTP (Online Transaction Processing):
   Это тип рабочих нагрузок, ориентированных на частые, быстрые транзакции с данными.
   - Короткие, частые транзакции: INSERT, UPDATE, DELETE.
   - Высокая конкурентность.
   - Данные в 3NF (нормализованные).
   - Примеры: PostgreSQL, MySQL, SQL Server.
2. OLAP (Online Analytical Processing):
   Тип нагрузки, связанный с аналитикой и большими объёмами чтения.
   - Долгие, ресурсоёмкие запросы: SELECT с агрегатами.
   - Использует денормализацию, star/snowflake схемы.
   - Примеры: ClickHouse, Amazon Redshift, BigQuery.
   - Хранилища — часто колоночные.
     Под OLTP — row-based БД. Под OLAP — columnar.

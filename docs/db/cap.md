# CAP theorem

CAP (она же теорема Брюера) — в распределённой системе невозможно одновременно гарантировать все три свойства (C, A и P).
Можно выбрать только два из трёх.

| Буква | Свойство                                               | Значение                                                               |
| :---- | :----------------------------------------------------- | :--------------------------------------------------------------------- |
| **C** | *Consistency* (согласованность)                        | Все узлы видят одинаковые данные в одно и то же время.                 |
| **A** | *Availability* (доступность)                           | Каждый запрос получает ответ (даже если часть системы недоступна).     |
| **P** | *Partition tolerance* (устойчивость к разделению сети) | Система продолжает работать, даже если связь между узлами прерывается. |


--- 

## Почему это важно

Распределённая система (например, кластер БД или микросервисов) состоит из нескольких машин, которые могут временно терять связь друг с другом.
В этот момент нужно решить:
- что важнее — данные всегда одинаковые (Consistency),
- или система всегда отвечает (Availability).
 
---

## Комбинации

| Тип системы | Что выбирает                                | Что теряет                           | Примеры                                                      |
| :---------- | :------------------------------------------ | :----------------------------------- | :----------------------------------------------------------- |
| **CA**      | Согласованность + Доступность               | Неустойчива к разделению             | Обычно **односерверные** системы (PostgreSQL без репликации) |
| **CP**      | Согласованность + Устойчивость к разделению | Может временно не отвечать           | **HBase**, **MongoDB (в строгом режиме)**                    |
| **AP**      | Доступность + Устойчивость к разделению     | Возможна временная несогласованность | **Cassandra**, **DynamoDB**, **Riak**                        |

---

# Для чего это знать разработчику

CAP помогает понимать, какие гарантии реально обеспечит твоя система и чего от неё ждать при сбоях:

- При проектировании распределённых БД, микросервисов, кешей, message broker'ов.
- При выборе технологий:
  - для банковской системы выбирают CP (точность важнее скорости);
  - для соцсетей или кешей — AP (доступность важнее абсолютной согласованности).